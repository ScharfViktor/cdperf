"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _chunkS3XPLQ4Njs = require('./__chunk/chunk-S3XPLQ4N.js');var _chunkULPJ3NPSjs = require('./__chunk/chunk-ULPJ3NPS.js');var _chunkVLZCO2CVjs = require('./__chunk/chunk-VLZCO2CV.js');var _chunkBNLEE57Mjs = require('./__chunk/chunk-BNLEE57M.js');var _crypto = require('k6/crypto');var N={vus:1,insecureSkipTLSVerify:!0,setupTimeout:"1h"};async function $(){let e=_chunkBNLEE57Mjs.t.call(void 0, ),r=_chunkBNLEE57Mjs.v.call(void 0, {userLogin:e.admin.login,userPassword:e.admin.password}),o=await _chunkULPJ3NPSjs.b.call(void 0, {client:r,resourceName:e.seed.container.name,resourceType:e.seed.container.type,userLogin:e.admin.login,platform:e.platform.type});if(e.seed.groups.create){let a=_chunkVLZCO2CVjs.c.call(void 0, {pool:_chunkVLZCO2CVjs.a,n:e.seed.groups.total});await Promise.all(a.map(async({groupName:t})=>{let s=r.group.createGroup({groupName:t}),[n]=_chunkBNLEE57Mjs.l.call(void 0, "id",s.body);_chunkBNLEE57Mjs.o.call(void 0, n||t)}))}if(e.seed.users.create){let a=_chunkVLZCO2CVjs.c.call(void 0, {pool:_chunkVLZCO2CVjs.b,n:e.seed.users.total}),t=r.role.getRoles(),[s]=_chunkBNLEE57Mjs.l.call(void 0, "$.bundles[?(@.name === 'spaceadmin')].id",_optionalChain([t, 'optionalAccess', _ => _.body])),n=r.application.listApplications(),[l]=_chunkBNLEE57Mjs.l.call(void 0, "$.value[?(@.displayName === 'ownCloud Infinite Scale')].id",_optionalChain([n, 'optionalAccess', _2 => _2.body]));await Promise.all(a.map(async i=>{let I=r.user.createUser(i),[v]=_chunkBNLEE57Mjs.l.call(void 0, "$.id",I.body);await r.user.enableUser(i),await r.role.addRoleToUser({appRoleId:s,resourceId:l,principalId:v});let d=await _chunkBNLEE57Mjs.w.call(void 0, {client:r,root:o.root,path:o.path,shareReceiver:i.userLogin,type:e.seed.container.type});d&&await _chunkBNLEE57Mjs.v.call(void 0, i).share.acceptShare({shareId:d})}))}await r.resource.createResource({root:[o.root,o.path].join("/"),resourcePath:e.seed.resource.root}),await Promise.all([e.seed.resource.small,e.seed.resource.medium,e.seed.resource.large].map(async a=>{await r.resource.uploadResource({root:[o.root,o.path,e.seed.resource.root].join("/"),resourcePath:a.name,resourceBytes:_crypto.randomBytes.call(void 0, a.size)})}));{let a=_chunkS3XPLQ4Njs.a.call(void 0, {root:e.seed.calendar.root,fromYear:e.seed.calendar.from_year,toYear:e.seed.calendar.to_year});await r.resource.createResource({root:[o.root,o.path].join("/"),resourcePath:a.root}),await Promise.all(a.y.map(async t=>{await r.resource.createResource({root:[o.root,o.path].join("/"),resourcePath:t})})),await Promise.all(a.m.map(async t=>{await r.resource.createResource({root:[o.root,o.path].join("/"),resourcePath:t})})),await Promise.all(a.d.map(async t=>{await r.resource.createResource({root:[o.root,o.path].join("/"),resourcePath:t})})),await Promise.all(a.d.map(async t=>{let s=_chunkS3XPLQ4Njs.b.call(void 0, {v:t});await r.resource.uploadResource({root:[o.root,o.path].join("/"),resourcePath:s.resourcePath,resourceBytes:s.resourceContent})}))}}function C(){}exports.default = C; exports.options = N; exports.setup = $;
